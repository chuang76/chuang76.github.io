<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="">

    
      <link href="https://fonts.googleapis.com/css?family=Open+Sans:400|Old+Standard+TT:400&display=swap" rel="stylesheet" media="print" type="text/css" onload="this.media='all'">
    

    <title>
      
      
         Writeup: Nebula (level 7) 
      
    </title>
    <link rel="canonical" href="https://chuang76.github.io/posts/nebula_p6/">

    <style>
  * {
    border:0;
    font:inherit;
    font-size:100%;
    vertical-align:baseline;
    margin:0;
    padding:0;
    color: black;
    text-decoration-skip: ink;
  }

  body {
     
     
    font-family: 'Verdana'; 
     
     
    font-size:17px;
    line-height:160%;
    color:#1d1313;
    max-width:700px;
    margin:auto;
  }

  p {
    margin: 20px 0;
  }

  a img {
    border:none;
  }

  img {
    margin: 10px auto 10px auto;
    max-width: 100%;
    display: block;
  }

  .left-justify { float: left; }
  .right-justify { float:right; }

  pre, code {
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
    background-color: #f7f7f7;
  }

  code {
    font-size: 12px;
    padding: 4px;
  }

  pre {
    margin-top: 0;
    margin-bottom: 16px;
    word-wrap: normal;
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
  }

  pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
  }

  pre code {
    display: inline;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
  }

  pre code::before,
  pre code::after {
    content: normal;
  }

  em,q,em,dfn {
    font-style:italic;
  }

  .sans,html .gist .gist-file .gist-meta {
    font-family:"Open Sans","Myriad Pro",Myriad,sans-serif;
  }

  .mono,pre,code,tt,p code,li code {
    font-family:Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace;
  }

  .heading,.serif,h1,h2,h3 {
    font-family:"Old Standard TT",serif;
  }

  strong {
    font-weight:600;
  }

  q:before {
    content:"\201C";
  }

  q:after {
    content:"\201D";
  }

  del,s {
    text-decoration:line-through;
  }

  blockquote {
    font-family:"Old Standard TT",serif;
    text-align:center;
    padding:50px;
  }

  blockquote p {
    display:inline-block;
    font-style:italic;
  }

  blockquote:before,blockquote:after {
    font-family:"Old Standard TT",serif;
    content:'\201C';
    font-size:35px;
    color:#403c3b;
  }

  blockquote:after {
    content:'\201D';
  }

  hr {
    width:40%;
    height: 1px;
    background:#403c3b;
    margin: 25px auto;
  }

  h1 {
    font-size:35px;
  }

  h2 {
    font-size:28px;
  }

  h3 {
    font-size:22px;
    margin-top:18px;
  }

  h1 a,h2 a,h3 a {
    text-decoration:none;
  }

  h1,h2 {
    margin-top:28px;
  }

  #sub-header, .date {
    color:#403c3b;
    font-size:13px;
  }

  #sub-header {
    margin: 0 4px;
  }

  #nav h1 a {
    font-size:35px;
    color:#1d1313;
    line-height:120%;
  }

  .posts_listing a,#nav a {
    text-decoration: none;
  }

  li {
    margin-left: 20px;
  }

  ul li {
    margin-left: 5px;
  }

  ul li {
    list-style-type: none;
  }
  ul li:before {
    content:"\00BB \0020";
  }

  #nav ul li:before, .posts_listing li:before {
    content:'';
    margin-right:0;
  }

  #content {
    text-align:left;
    width:100%;
    font-size:15px;
    padding:60px 0 80px;
  }

  #content h1,#content h2 {
    margin-bottom:5px;
  }

  #content h2 {
    font-size:25px;
  }

  #content .entry-content {
    margin-top:15px;
  }

  #content .date {
    margin-left:3px;
  }

  #content h1 {
    font-size:30px;
  }

  .highlight {
    margin: 10px 0;
  }

  .posts_listing {
    margin:0 0 50px;
  }

  .posts_listing li {
    margin:0 0 25px 15px;
  }

  .posts_listing li a:hover,#nav a:hover {
    text-decoration: underline;
  }

  #nav {
    text-align:center;
    position:static;
    margin-top:60px;
  }

  #nav ul {
    display: table;
    margin: 8px auto 0 auto;
  }

  #nav li {
    list-style-type:none;
    display:table-cell;
    font-size:15px;
    padding: 0 20px;
  }

  #links {
    display: flex;
    justify-content: space-between;
    margin: 50px 0 0 0;
  }

  #links :nth-child(1) {
    margin-right:0.5em;;
  }

  #links :nth-child(2) {
    margin-left:0.5em;;
  }

  #not-found {
    text-align: center;
  }

  #not-found a {
    font-family:"Old Standard TT",serif;
    font-size: 200px;
    text-decoration: none;
    display: inline-block;
    padding-top: 225px;
  }

  @media (max-width: 750px) {
    body {
      padding-left:20px;
      padding-right:20px;
    }

    #nav h1 a {
      font-size:28px;
    }

    #nav li {
      font-size:13px;
      padding: 0 15px;
    }

    #content {
      margin-top:0;
      padding-top:50px;
      font-size:14px;
    }

    #content h1 {
      font-size:25px;
    }

    #content h2 {
      font-size:22px;
    }

    .posts_listing li div {
      font-size:12px;
    }
  }

  @media (max-width: 400px) {
    body {
      padding-left:20px;
      padding-right:20px;
    }

    #nav h1 a {
      font-size:22px;
    }

    #nav li {
      font-size:12px;
      padding: 0 10px;
    }

    #content {
      margin-top:0;
      padding-top:20px;
      font-size:12px;
    }

    #content h1 {
      font-size:20px;
    }

    #content h2 {
      font-size:18px;
    }

    .posts_listing li div{
      font-size:12px;
    }
  }

  @media (prefers-color-scheme: dark) {
    *, #nav h1 a {
      color: #FDFDFD;
    }

    body {
      background: #121212;
    }

    pre, code {
      background-color: #262626;
    }

    #sub-header, .date {
      color: #BABABA;
    }

    hr {
      background: #EBEBEB;
    }
  }
</style>


    </head>

  <body>
    <section id=nav>
      <h1><a href="https://chuang76.github.io/">Before Dawn</a></h1>
      <ul>
        
      </ul>
    </section>


<section id=content>
  <h1> Writeup: Nebula (level 7) </h1>

  
    <div id=sub-header>
      December 2020 
    </div>
  

  <div class="entry-content">
    <p>Nebula is a virtual machine that covers a variety of challenges about Linux privilege escalation, scripting language issues, and file system race conditions. It is available at <a href="https://exploit-exercises.lains.space/">Exploit Exercises</a>.</p>
<!-- raw HTML omitted -->
<h2 id="level-7">Level 7</h2>
<p>Here is the description of Level 7.</p>
<pre><code>The flag07 user was writing their very first perl program that allowed them to 
ping hosts to see if they were reachable from the web server.

To do this level, log in as the level07 account with the password level07. 
Files for this level can be found in /home/flag07.
</code></pre><p>The contents in /home/flag07 can be displayed as follows.</p>
<p><img src="https://github.com/chuang76/image/blob/master/07-1.PNG?raw=true" alt=""></p>
<p>Let&rsquo;s view the contents of the file index.cgi. It is a CGI script written in Perl. <a href="https://en.wikipedia.org/wiki/Common_Gateway_Interface">CGI</a> (Common Gateway Interface) is a specification for web servers to execute programs like command-line running on a server that generates dynamic web pages. As you can see, we need to provide the parameter Host to index.cgi. Then, the ping result will be displayed on the screen. We can check that if index.cgi works successfully or not.</p>
<p><img src="https://github.com/chuang76/image/blob/master/07-3.PNG?raw=true" alt=""></p>
<pre><code>#!/usr/bin/perl

use CGI qw{param};

print &quot;Content-type: text/html\n\n&quot;;

sub ping {
  $host = $_[0];

  print(&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Ping results&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;&quot;);

  @output = `ping -c 3 $host 2&gt;&amp;1`;
  foreach $line (@output) { print &quot;$line&quot;; }

  print(&quot;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&quot;);
  
}

# check if Host set. if not, display normal page, etc

ping(param(&quot;Host&quot;));
</code></pre><p>Subsequently, let&rsquo;s view the contents of the file thttpd.conf. <a href="https://en.wikipedia.org/wiki/Thttpd">Thttpd</a> is a simple web server, and thttpd.conf is its configure file. Here is the part of thttpd.conf. As you can see, thttpd is listening to the port 7007, running with our target account fla07, and it supports the CGI program, index.cgi.</p>
<pre><code>port=7007
dir=/home/flag07
user=flag07
cgipat=**.cgi
</code></pre><p>So, we can use wget command to retrieve the response. For example, we can get the result of whoami. Note that the semicolon (;) character should be encoded as &ldquo;%3B&rdquo; in URL.</p>
<p><img src="https://github.com/chuang76/image/blob/master/07-4.PNG?raw=true" alt=""></p>
<p>Here is the flag.</p>
<p><img src="https://github.com/chuang76/image/blob/master/07-5.PNG?raw=true" alt=""></p>

  </div>

  <div id=links>
    
      <a href="https://chuang76.github.io/posts/nebula_p5/">&laquo;&nbsp;Writeup: Nebula (level 6)</a>
    
    
  </div>
</section>

  
</body>
</html>



